# Incident Response Documentation

## Incident Summary
**Title:** Incident Response on Malware
**Name** CUSTOM: Malware Detected Rule in Sentinel  
**ID:** 15  
**Severity:** High  
**Initial Detection:** 12/29/2023, 10:05 AM  
**Detection Tool:** Microsoft Sentinel  
**Status:** Active  

- ![Architecture Diagram](https://i.imgur.com/ANrAG3W.jpg)
---

## Initial Detection

- **Date and Time of Detection:** 12/29/2023, 10:05 AM
- **Detection Tool:** Microsoft Sentinel
- **Initial Status:** New, Unassigned
- **Severity:** High
- ![Architecture Diagram](https://i.imgur.com/B4x5FsO.jpg)
---

## Incident Assignment and Findings

- **Owner:** Eric R
- **Assignment Time:** 12/29/2023, shortly after detection
- **Status Update:** Active
- **Events:** 396
- **Alerts:** 7
- All alerts had a high severity level, indicating a serious threat.
- ![Architecture Diagram](https://i.imgur.com/VgvoFCX.jpg)

## Investigation and Analysis

### Log Analysis

- Ran queries in Microsoft Sentinel to gather logs related to the incident.
- Checked for the number of alerts, events, and other related metrics.
- ![Architecture Diagram](https://i.imgur.com/ueY0Zzi.jpg)
  
### Timeline Review

- Reviewed the incident timeline to trace the activities and alerts over time.

#### Findings

- Multiple alerts for 'CUSTOM: Malware Detected' were triggered in a short span, suggesting a concerted malware attack or outbreak.

---

## Topology and Impact Analysis

- **Affected Entities:** windows-vm (a Windows virtual machine)
- ![Architecture Diagram](https://i.imgur.com/1OPYkfr.jpg)

#### Findings

- The incident seemed to be contained within the windows-vm entity with no immediate indication of lateral movement or multiple affected hosts.

---

## Similar Incidents

- Searched for and reviewed similar incidents for patterns and commonalities.

#### Findings

- Identified other high-severity incidents such as 'CUSTOM: Windows Host Firewall Tampering' which may be related.

---

## Actions Taken

- **Resolution Status:** Closed
- **Next Steps:**
  - Continue monitoring for new alerts or changes in incident severity.
  - Implement containment measures on the affected windows-vm.
  - Run an anti-virus and malware protection locally on the machine at all times.
  - Update your machine weekly to bi-weekly rotation to align with Patch Tuesdays from Microsoft.
  - Update incident playbook with any new insights gained from this incident.

---

**Documentation Author:** Eric Noga  
**Date:** 1/1/2024
